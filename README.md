# Flow Go ECDSA

* Run `flow emulator start -v` at the root of this project
* Run `go build && ./flow-go-ecdsa`

Flow is using ecdsa as signing algorithms(nistp256 and secp256k1). For other blockchains like Bitcoin/Ethereum, they choose the low-s form signature as the canonical one to prevent the problems caused by transaction malleability. But on Flow, both low-s form signature and high-s form signature are regarded as valid. We can check it via `HighSSignatureDemo`. Due to the malleability of signature, the transaction malleability attack would be possible on Flow. We can check it via `ReplaceTransactionSignatureDemo`.

## HighSSignatureDemo

In this function, we:

* generate a high-s form signature `origSig` by flow-go-sdk
* check the validity of `origSig` by flow-go-sdk(which is **VALID**)
* check the validity of `origSig` by go-ethereum(which is **INVALID**)
* calculate the low-s form signature `trickSig`
* check the validity of `trickSig` by flow-go-sdk(which is **VALID**)
* check the validity of `trickSig` by go-ethereum(which is **VALID**)

This means certain signatures generated by Flow(i.e, high-s form) might be regarded as invalid on other mainstream blockchains(Bitcoin/Ethereum/Cosmos, etc), and high-s signatures that are invalid on other blockchains might be deemed as valid on Flow.

I think this will cause inconvinience for the possible `interoperation` between Flow and other chains.

## ReplaceTransactionSignatureDemo

In this function, we:
* create a flow account by using a secp256k1 keypair
* create and sign a new transaction `tx`, get the envelop signature `origSig`
* calculate the txid of the `tx` and get `origTxID`
* calculate the second valid signature: `trickSig` 
* replace the `origSig` in `tx` with `trickSig`
* calculate the txid of the `tx` and get `trickTxID`
* broadcast the tx with `trickSig`

You will find that the `tx` can be broadcasted successfully and the `trickTxID` is totally different with `origTxID`, which means we have successfully performed a transaction malleability attack.